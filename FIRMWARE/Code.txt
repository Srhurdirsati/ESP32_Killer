#include "RF24.h"

#include <SPI.h>

#include "esp_bt.h"

#include "esp_wifi.h"

// SPI

SPIClass *sp = nullptr;

SPIClass *hp = nullptr;

// NRF24 Module

RF24 radio(26, 15, 16000000); // NRF24-1 HSPI

RF24 radio1(4, 2, 16000000); // NRF24-2 VSPI

// Flags und Kanalvariablen

unsigned int flag = 0; // HSPI Flag

unsigned int flagv = 0; // VSPI Flag

int ch = 45; // HSPI Kanal

int ch1 = 45; // VSPI Kanal

// GPIO f체r LED

const int LED_PIN = 2; // GPIO2 f체r die eingebaute LED des ESP32

void two() {

if (flagv == 0) {

ch1 += 4;

} else {

ch1 -= 4;

}

if (flag == 0) {

ch += 2;

} else {

ch -= 2;

}

if ((ch1 > 79) && (flagv == 0)) {

flagv = 1;

} else if ((ch1 < 2) && (flagv == 1)) {

flagv = 0;

}

if ((ch > 79) && (flag == 0)) {

flag = 1;

} else if ((ch < 2) && (flag == 1)) {

flag = 0;

}

radio.setChannel(ch);

radio1.setChannel(ch1);

}

void one() {

// Zuf채lliger Kanal

radio1.setChannel(random(80));

radio.setChannel(random(80));

delayMicroseconds(random(60));

}

void setup() {

Serial.begin(115200);

// Deaktiviere Bluetooth und WLAN

esp_bt_controller_deinit();

esp_wifi_stop();

esp_wifi_deinit();

esp_wifi_disconnect();

// Initialisiere SPI

initHP();

initSP();

// Initialisiere LED-Pin

pinMode(LED_PIN, OUTPUT); // Setze den GPIO-Pin als Ausgang

}

void initSP() {

sp = new SPIClass(VSPI);

sp->begin();

if (radio1.begin(sp)) {

Serial.println("VSPI Jammer Started !!!");

radio1.setAutoAck(false);

radio1.stopListening();

radio1.setRetries(0, 0);

radio1.setPALevel(RF24_PA_MAX, true);

radio1.setDataRate(RF24_2MBPS);

radio1.setCRCLength(RF24_CRC_DISABLED);

radio1.printPrettyDetails();

radio1.startConstCarrier(RF24_PA_MAX, ch1);

} else {

Serial.println("VSPI Jammer couldn't start !!!");

}

}

void initHP() {

hp = new SPIClass(HSPI);

hp->begin();

if (radio.begin(hp)) {

Serial.println("HSPI Jammer Started !!!");

radio.setAutoAck(false);

radio.stopListening();

radio.setRetries(0, 0);

radio.setPALevel(RF24_PA_MAX, true);

radio.setDataRate(RF24_2MBPS);

radio.setCRCLength(RF24_CRC_DISABLED);

radio.printPrettyDetails();

radio.startConstCarrier(RF24_PA_MAX, ch);

} else {

Serial.println("HSPI Jammer couldn't start !!!");

}

}

void loop() {

// Zwei Module sollten kontinuierlich versetzt von einander hoppenn

two();

// Wenn der Jammer l채uft, blinkt die LED alle 1 Sekunde

digitalWrite(LED_PIN, HIGH); // LED an

delay(500); // 500 ms warten

digitalWrite(LED_PIN, LOW); // LED aus

delay(500); // 500 ms warten

}